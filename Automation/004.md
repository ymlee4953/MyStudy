# **001 - Ansible Setup**

## **OS update**
- update CentOS to latest
  d

## **Environment**
- d
  - d

## **Steps** 

### **Step 1: OS update**
-  update CentOS to latest
  - d
    - f

         
    - Done

          mkdir -p ~/ansible-playbooks/LB

          cat <<EOF> ~/ansible-playbooks/LB/install_haproxy.yml
          # install_haproxy.yml
          ---
          - hosts: lb*
            become: true
            tasks:
              - name: install base package 
                command: yum install -y gcc pcre-static pcre-devel
                command: yum install -y wget
                command: yum install -y make
                command: yum install -y openssl-devel

          - hosts: BASTION-0
            become: true
            tasks:
              - name: Fetch the etcdadm file from the Bastion_0
                fetch: 
                  src: ~/haproxy/haproxy-1.7.8.tar.gz/{{ item }}
                  dest: ~/files/
                with_items:
                - etcdadm
                - etcd-v3.4.9-linux-amd64.tar.gz                  
          EOF

          cat ~/ansible-playbooks/LB/install_haproxy.yml

          ansible-playbook -i k8s-cluster-hosts ~/ansible-playbooks/LB/install_haproxy.yml

    - execute copy

          ansible-playbook -i k8s-cluster-hosts ~/ansible-playbooks/LB/install_haproxy.yml
         

          cat ~/configurations/etc/yum.repos.d/nexus.repo


          cat <<EOF> ~/ansible-playbooks/initialize/set_yum_repo.yml
          # set_yum_repo.yml
          ---
          - hosts: etcd:master:worker:ingress:infra:lb*
            become: ture
            tasks:
              - name: copy airgap YUM Repo File
                copy:
                  src: ~/configurations/etc/yum.repos.d/nexus.repo
                  dest: /etc/yum.repos.d/nexus.repo
          EOF
2. init 
  -  
    - 
      -  

          cat <<EOF> ~/ansible-playbooks/LB/playbookfile.yml
          # playbookfile.yml
          ---
          - hosts: ETCD-1
            become: true
            tasks:
              - name: initialize etcd cluster
                command: ~/etcdadm init
          EOF

          cat ~/ansible-playbooks/LB/playbookfile.yml

          ansible-playbook -i k8s-cluster-hosts ~/ansible-playbooks/LB/playbookfile.yml
2. init 
  -  
    - 
      -  

          cat <<EOF> ~/ansible-playbooks/dirdir/playbookfile.yml
          # playbookfile.yml
          ---
          - hosts: ETCD-1
            become: true
            tasks:
              - name: initialize etcd cluster
                command: ~/etcdadm init
          EOF

          cat ~/ansible-playbooks/LB/playbookfile.yml

          ansible-playbook -i k8s-cluster-hosts ~/ansible-playbooks/LB/playbookfile.yml

2. init 
  -  
    - 
      -  

          cat <<EOF> ~/ansible-playbooks/dirdir/playbookfile.yml
          # playbookfile.yml
          ---
          - hosts: ETCD-1
            become: true
            tasks:
              - name: initialize etcd cluster
                command: ~/etcdadm init
          EOF

          cat ~/ansible-playbooks/LB/playbookfile.yml

          ansible-playbook -i k8s-cluster-hosts ~/ansible-playbooks/LB/playbookfile.yml

2. init 
  -  
    - 
      -  

          cat <<EOF> ~/ansible-playbooks/dirdir/playbookfile.yml
          # playbookfile.yml
          ---
          - hosts: ETCD-1
            become: true
            tasks:
              - name: initialize etcd cluster
                command: ~/etcdadm init
          EOF

          cat ~/ansible-playbooks/LB/playbookfile.yml

          ansible-playbook -i k8s-cluster-hosts ~/ansible-playbooks/LB/playbookfile.yml
